(this.webpackJsonp_widgets=this.webpackJsonp_widgets||[]).push([[0],{172:function(e,t,n){},189:function(e,t,n){},190:function(e,t,n){},389:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(19),l=n.n(c),o=(n(172),n(58)),s=n(18),i=(n(173),n(113)),u=n.n(i),m=(n(182),n(167)),d=n.n(m),p=(n(184),n(112)),h=n.n(p),f=(n(185),n(163)),g=n.n(f),y=n(88),b=n(47),v=n(48),k=n(50),E=n(49),C=(n(187),n(51)),w=n.n(C),M=(n(189),n(397)),O=n(166),S=n(396),j=(n(190),function(e){Object(k.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(b.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={icon:"arrows-alt",count:100,visible:!1},e}return Object(v.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{id:"headerbar"},r.a.createElement("div",{style:{lineHeight:"64px",float:"right"}},r.a.createElement("ul",{className:"header-ul"})))}}]),n}(a.Component)),K=(n(90),n(39)),I=n.n(K),N=function(e){Object(k.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(b.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={openKeys:[],selectedKeys:["4"],defaultNodeList:[]},e.handleClick=function(t){console.log("click ",t),e.setState({selectedKeys:["".concat(t.key)]}),e.props.onSelect("".concat(t.key))},e}return Object(v.a)(n,[{key:"render",value:function(){var e=this.state,t=(e.openKeys,e.selectedKeys);return r.a.createElement(I.a,{theme:"dark",mode:"horizontal",onClick:this.handleClick,selectedKeys:t},this.props.menus&&this.props.menus.map((function(e){return r.a.createElement(I.a.Item,{key:e.key},e.name)})))}}]),n}(r.a.Component),L=(Object(s.f)(N),I.a.SubMenu,function(e){Object(k.a)(n,e);var t=Object(E.a)(n);function n(){var e,a;Object(b.a)(this,n);for(var c=arguments.length,l=new Array(c),o=0;o<c;o++)l[o]=arguments[o];return(a=t.call.apply(t,[this].concat(l))).state={openKeys:[],selectedKeys:[null!==(e=a.props.current)&&void 0!==e?e:"47"],defaultNodeList:[]},a.onOpenChange=function(e){console.info("openKeys:",e),a.setState({openKeys:e})},a.renderMenuItem=function(e){return r.a.createElement(I.a.Item,{key:e.key,onClick:function(){return a.viewContent(e)}},r.a.createElement("span",null,e.title))},a.renderSubMenu=function(e){return r.a.createElement(I.a.SubMenu,{key:e.key,title:r.a.createElement("span",null,r.a.createElement("span",null,e.title))},e.children&&e.children.map((function(e){return e.children&&e.children.length>0?a.renderSubMenu(e):a.renderMenuItem(e)})))},a.viewContent=function(e){console.log(e),e.url&&window.history.pushState("","",e.url)},a.handleMenuClick=function(e){a.setState({selectedKeys:[e]});var t=P(a.props.menus,e);a.props.onMenuChange(t)},a}return Object(v.a)(n,[{key:"componentWillReceiveProps",value:function(e){if(e.menus!==this.props.menus){var t=P(e.menus,this.state.selectedKeys[0]);this.setState({openKeys:t.slice(0,-1).map((function(e){return e.key.toString()}))})}}},{key:"render",value:function(){var e=this,t=this.state,n=t.openKeys,a=t.selectedKeys;return r.a.createElement(I.a,{mode:"inline",onOpenChange:this.onOpenChange,onClick:function(t){var n=t.key;return e.handleMenuClick(n)},openKeys:n,selectedKeys:a,style:{height:"100%"}},this.props.menus&&this.props.menus.map((function(t){return t.children&&t.children.length>0?e.renderSubMenu(t):e.renderMenuItem(t)})))}}]),n}(r.a.Component)),P=function(e,t){var n=[];return function e(t,a,r){var c,l=!1,o=Object(y.a)(t);try{for(o.s();!(c=o.n()).done;){var s=c.value;if(s.key==a)return r.push(s),n=r,!0;if(s.children&&s.children.length){if(r.push(s),l=e(s.children,a,r))break;r.pop()}}}catch(i){o.e(i)}finally{o.f()}return l}(e,t,[]),n},_=Object(s.f)(L),F=[{id:1,key:1,title:"React Image Map",url:"/widget/react-image-map/",state:1,parent_id:0,oper_user_id:0}],A=w.a.Header,R=w.a.Sider,T=w.a.Content,W=w.a.Footer,x="last_selected_menu",B=function(e){Object(k.a)(n,e);var t=Object(E.a)(n);function n(e){var a;Object(b.a)(this,n),(a=t.call(this,e)).toggle=function(){a.setState({collapsed:!a.state.collapsed})},a.genActiveRule=function(e){return function(t){return t.pathname.startsWith(e)}},a.handleClick=function(e){console.log("click ",e),a.setState({current:e.key})},a.getSubTree=function(){var e=a.state.current,t=null;return a.state.menu.forEach((function(n){n.key===e&&(t=n.children)})),t},a.getMenuQuery=function(){console.log("\u6267\u884c");var e=F;a.setState({menu:a.filterVisibleMenu(e)}),a.state.current&&a.handleMenuChange(P(e,a.state.current))},a.filterVisibleMenu=function(e){var t,n=[],r=Object(y.a)(e);try{for(r.s();!(t=r.n()).done;){var c=t.value;[2,3].includes(c.authority_type)||(n.push(c),c.children&&(c.children=a.filterVisibleMenu(c.children)))}}catch(l){r.e(l)}finally{r.f()}return n},a.handleMenuChange=function(e){a.setState({currentMenuPaths:e}),e.length&&localStorage.setItem(x,e[e.length-1].key)};var r=localStorage.getItem(x);return a.state={current:null!==r&&void 0!==r?r:"47",loading:!1,collapsed:!1,subLoader:null,menu:[],currentMenuPaths:[]},a}return Object(v.a)(n,[{key:"componentDidMount",value:function(){var e=function(e){var t=document.getElementById("subapp-container");l.a.render(r.a.createElement(r.a.Fragment,null,r.a.createElement(g.a,{style:{position:"absolute",top:"50%",left:"50%"},spinning:e}),r.a.createElement("div",{id:"subapp-viewport"})),t)};this.setState({loading:!0,subLoader:e}),Object(M.b)([{name:"subapp",entry:"//".concat(window.location.host,"/react-image-map/"),container:"#subapp-viewport",loader:e,activeRule:"/widget/react-image-map/"}],{beforeLoad:[function(e){return new Promise((function(t,n){console.log("[LifeCycle] before load %c%s","color: green;",e.name),t(e.name)}))}],beforeMount:[function(e){return new Promise((function(t,n){console.log("[LifeCycle] before mount %c%s","color: green;",e.name),t(e.name)}))}],afterUnmount:[function(e){return new Promise((function(t,n){console.log("[LifeCycle] after unmount %c%s","color: green;",e.name),t(e.name)}))}]});var t=Object(O.b)({user:"qiankun"}),n=t.onGlobalStateChange,a=t.setGlobalState;n((function(e,t){return console.log("[onGlobalStateChange - master]:",e,t)})),a({ignore:"master",user:{name:"master"}}),Object(M.c)(),this.getMenuQuery(),Object(S.a)((function(){console.log("[MainApp] first app mounted")}))}},{key:"render",value:function(){var e=this.state,t=e.menu;e.current,e.subLoader,this.getSubTree();return r.a.createElement(o.a,null,r.a.createElement(w.a,{className:"widgets-layout"},r.a.createElement(A,{className:"header"},r.a.createElement("div",{className:"logo"},"Widgets"),r.a.createElement(d.a,{justify:"space-around"},r.a.createElement(h.a,{xs:{span:20},lg:{span:20}}),r.a.createElement(h.a,{xs:{span:24},lg:{span:4}},r.a.createElement(j,null)))),r.a.createElement(w.a,{className:"widgets-layout-content"},r.a.createElement(R,{width:200,collapsed:this.state.collapsed,onCollapse:this.state.collapsed},r.a.createElement(_,{menus:t,current:this.state.current,onMenuChange:this.handleMenuChange})),r.a.createElement(w.a,{className:"widgets-layout-container"},r.a.createElement(u.a,{className:"widgets-layout-container-breadcrumd"},this.state.currentMenuPaths.map((function(e){return r.a.createElement(u.a.Item,{key:e.id},e.title)}))),r.a.createElement(T,{className:"site-layout-background"},r.a.createElement("div",{id:"subapp-container",className:"view"})),r.a.createElement(W,{className:"widgets-layout-container-footer"},"Widgets \xa92021 Created by qiuz")))))}}]),n}(a.Component),G=function(){return r.a.createElement(o.a,{basename:"/widget"},r.a.createElement(s.c,null,r.a.createElement(s.a,{path:"*",component:B})))},V=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,398)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,l=t.getTTFB;n(e),a(e),r(e),c(e),l(e)}))};l.a.render(r.a.createElement(G,null),document.getElementById("root")),V()}},[[389,1,2]]]);
//# sourceMappingURL=main.56e65e87.chunk.js.map